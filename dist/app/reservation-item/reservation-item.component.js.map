{"version":3,"sources":["../src/app/reservation-item/reservation-item.component.ts"],"names":[],"mappings":";;;;;;;;;;AAAA,uBAA+C,eAAe,CAAC,CAAA;AAC/D,yBAA+C,iBAAiB,CAAC,CAAA;AAEjE,8BAA2B,yBAAyB,CAAC,CAAA;AACrD,+BAA4B,0BAA0B,CAAC,CAAA;AAEvD,MAAY,EAAE,WAAM,kBAAkB,CAAC,CAAA;AA0BvC;IAQI,YAAoB,UAAsB,EACtB,WAAwB,EACvB,KAAqB,EACrB,MAAc;QAHf,eAAU,GAAV,UAAU,CAAY;QACtB,gBAAW,GAAX,WAAW,CAAa;QACvB,UAAK,GAAL,KAAK,CAAgB;QACrB,WAAM,GAAN,MAAM,CAAQ;IACnC,CAAC;IAED,QAAQ;QACN,IAAI,CAAC,MAAM,GAAG,EAAE,EAAE,CAAC;QACnB,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,qBAAqB,EAAE,CAAC,WAAgB;YACrD,EAAE,CAAC,CAAC,IAAI,CAAC,WAAW,CAAC,cAAc,IAAI,WAAW,CAAC,cAAc,CAAC,CAAC,CAAC;gBAClE,IAAI,CAAC,WAAW,GAAG,WAAW,CAAC;YACjC,CAAC;QACH,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,WAAW,CAAC,WAAW,EAAE;YAC5C,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;QAC3C,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IAChB,CAAC;IAEO,YAAY,CAAC,WAAmB,EAAE,QAAkB;QAC1D,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,WAAW,CAAC;aACvC,SAAS,CAAC,QAAQ;YACjB,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;YACzB,QAAQ,EAAE,CAAA;QACZ,CAAC,CAAC,CAAC;IACL,CAAC;IAEO,SAAS,CAAC,QAAgB;QAChC,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,QAAQ,CAAC;aACjC,SAAS,CAAC,KAAK;YACd,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACrB,CAAC,CAAC,CAAC;IACL,CAAC;IAEO,aAAa,CAAC,KAAU;QAC9B,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;YACxB,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,aAAa,EAAE,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;QAC7D,CAAC;IACH,CAAC;IAEO,gBAAgB,CAAC,KAAU;QACjC,IAAI,cAAc,GAAG,IAAI,CAAC,WAAW,CAAC;QACtC,cAAc,CAAC,QAAQ,IAAI,CAAC,CAAC;QAC7B,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,oBAAoB,EAAE,cAAc,CAAC,CAAC;IACzD,CAAC;IAEO,gBAAgB,CAAC,KAAU;QACjC,EAAE,CAAC,CAAC,IAAI,CAAC,WAAW,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC,CAAC;YAClC,IAAI,cAAc,GAAG,IAAI,CAAC,WAAW,CAAC;YACtC,cAAc,CAAC,QAAQ,IAAI,CAAC,CAAC;YAC7B,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,oBAAoB,EAAE,cAAc,CAAC,CAAC;QACzD,CAAC;IACH,CAAC;AACL,CAAC;AA1DG;IAAC,YAAK,EAAE;;oDAAA;AA1BZ;IAAC,gBAAS,CAAC;QACP,QAAQ,EAAE,MAAM,CAAC,EAAE;QACnB,QAAQ,EAAE,kBAAkB;QAC5B,QAAQ,EAAC;;;;;;;;;;;;;;;;;KAiBR;QACD,SAAS,EAAE,CAAC,6BAA6B,CAAC;QAC1C,SAAS,EAAE,CAAE,wBAAU,EAAE,0BAAW,CAAE;KACzC,CAAC;;mBAAA;AACW,uBAAe,kBA4D3B,CAAA","file":"app/reservation-item/reservation-item.component.js","sourceRoot":"/source/","sourcesContent":["import { Component, Input, HostListener } from '@angular/core';\nimport { Router, ActivatedRoute, Params } from '@angular/router';\n\nimport { ApiService } from '../services/api.service';\nimport { AuthService } from '../services/auth.service';\n\nimport * as io from 'socket.io-client';\n\n@Component({\n    moduleId: module.id,\n    selector: 'reservation-item',\n    template:`\n    <div *ngIf='movie && showtime' class='reservation-wrapper'>\n      <div class='reservation-header' [ngStyle]=\"{\n        'background': 'linear-gradient( rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5) ), url(' + movie.backdrop_url + ')', \n        'background-position':'center', \n        'background-size':'cover'}\" (click)='headerClicked($event)'>\n        <div *ngIf='movie' class='title'>{{movie.title}}</div>\n        <span *ngIf='showtime' class='date'>{{showtime.time.replace('T', ' ').replace('Z', '') | date: 'EEEE, MMMM d'}}</span>\n        <span *ngIf='showtime' class='time'>{{showtime.time.replace('T', ' ').replace('Z', '') | date: 'h:m a'}}</span>\n      </div>\n      <div class='reservation-sub'>Admit</div>\n      <div>\n        <button class='reservation-button' (click)='decrementClicked($event)'>-</button>\n        <span class='reservation-quantity'>{{reservation.quantity}}</span>\n        <button class='reservation-button' (click)='incrementClicked($event)'>+</button>\n      </div>\n    </div>\n    `,\n    styleUrls: ['reservation-item.styles.css'],\n    providers: [ ApiService, AuthService ]\n})\nexport class ReservationItem {\n  \n    @Input() reservation: any;\n    \n    showtime: any;\n    movie: any;\n    socket: any;\n    \n    constructor (public apiService: ApiService,\n                 public authService: AuthService,\n                 private route: ActivatedRoute,\n                 private router: Router){ \n    }\n    \n    ngOnInit() {\n      this.socket = io();\n      this.socket.on('reservation:updated', (reservation: any) => {\n        if (this.reservation.reservation_id == reservation.reservation_id) {\n          this.reservation = reservation;\n        }\n      });\n      this.loadShowtime(this.reservation.showtime_id, function() {\n          this.loadMovie(this.showtime.movie_id);\n      }.bind(this));\n    }\n    \n    private loadShowtime(showtime_id: number, complete: Function) {\n      this.apiService.getShowtime(showtime_id)\n      .subscribe(showtime => {\n        this.showtime = showtime;\n        complete()\n      });\n    }\n    \n    private loadMovie(movie_id: number) {\n      this.apiService.getMovie(movie_id)\n      .subscribe(movie => {\n        this.movie = movie;\n      });\n    }\n    \n    private headerClicked(event: any) {\n      if (this.movie.movie_id) {\n        this.router.navigate(['/home/movie', this.movie.movie_id]);\n      }\n    }\n    \n    private incrementClicked(event: any) {\n      var newReservation = this.reservation;\n      newReservation.quantity += 1;\n      this.socket.emit('reservation:update', newReservation);\n    }\n    \n    private decrementClicked(event: any) {\n      if (this.reservation.quantity > 1) {\n        var newReservation = this.reservation;\n        newReservation.quantity -= 1;\n        this.socket.emit('reservation:update', newReservation);\n      }\n    }\n}"]}